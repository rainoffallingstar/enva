---
description:执行任务
---
# 执行任务

按以下流程执行 TODO 中的下一个任务：

------------------------------------------------------------------------

## Step 1: 上下文加载

1.  执行 `todoread` 查看当前任务列表，读取plan获取尚未完成的计划
2.  选择优先级最高的 `pending` 任务，如没有任务，根据尚未完成的计划设计任务。
3.  读取以下文件：
    -   `docs/active_context.md` - 系统现状
    -   `docs/architecture.md` - 设计规范
    -   `docs/schema.sql` - 数据库结构
4.  使用 `todowrite` 将任务状态改为 `in_progress`

------------------------------------------------------------------------

## Step 2: 数据流检查

1.  查看 `active_context.md` 中已有的接口和模块
2.  确认任务涉及的数据流向
3.  检查是否与 `architecture.md` 一致
4.  如有冲突，先解决冲突再继续

------------------------------------------------------------------------

## Step 3: 类型定义 (必须先行)

如果是新功能： 1. 在 `src/types/` 中定义相关 Interface 2. 确保类型定义完整覆盖所有数据节点 3. 更新 `src/types/index.ts` 导出新类型

------------------------------------------------------------------------

## Step 4: 编码实现

1.  基于已定义的 Interface 编写代码
2.  确保模块间调用使用强类型
3.  编写验证脚本或单元测试
4.  运行测试确保逻辑正确

------------------------------------------------------------------------

## Step 5: 收尾更新 ⭐关键

### 5.1 更新 TODO

使用 `todowrite` 将任务标记为 `completed`

### 5.2 更新 active_context.md

**必须**按以下格式重写（保持 100 行以内）：

``` markdown
# System Context (Updated: [今日日期])

## 1. 已实现的核心模块 (Modules)

### [新增/修改的模块名]
- **Path**: `src/xxx/`
- **Public Methods**: 
  - `methodName(ParamType): ReturnType` - 功能描述
- **Data Flow**: 数据流向描述
- **Dependencies**: 依赖的其他模块

[保留其他已有模块信息]

## 2. 全局数据结构 (Global Types)

| Type Name | File Path | Key Fields | 使用场景 |
|-----------|-----------|------------|----------|
| [新增类型] | src/types/xxx.ts | field1, field2 | 使用场景 |
[保留其他已有类型]

## 3. API 端点注册表

| Method | Endpoint | Request Type | Response Type |
|--------|----------|--------------|---------------|
| [新增端点] | | | |
[保留其他已有端点]

## 4. 待解决的技术债

- [ ] [新发现的问题] (优先级)
[保留其他未解决的技术债]
```

5.3 检查新任务

如发现新的待办事项，使用 todowrite 添加 输出格式

任务完成后输出：

```         
 完成的任务: 任务描述
 修改的文件: 文件列表
 新增的类型: Interface 名称和位置
 下一步建议: 后续任务建议
```
